True
Args in experiment:
[1mBasic Config[0m
  Task Name:          long_term_forecast  Is Training:        1                   
  Model ID:           bandwidth_16_16     Model:              Autoformer          

[1mData Loader[0m
  Data:               video               Root Path:          ./dataset/video/    
  Data Path:          gtscore_video.csv   Features:           S                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        ./checkpoints/      

[1mForecasting Task[0m
  Seq Len:            8                   Label Len:          1                   
  Pred Len:           8                   Seasonal Patterns:  Monthly             
  Inverse:            1                   

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             1                   Dec In:             1                   
  C Out:              1                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                
  Output Attention:   0                   

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       20                  Batch Size:         32                  
  Patience:           3                   Learning Rate:      0.0001              
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_bandwidth_16_16_Autoformer_video_ftS_sl8_ll1_pl8_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 38426
val 5505
test 16486
Epoch: 1, Iter: 1000/1201, Loss1: 0.2001221776008606, Loss2: 0.8027524352073669, Loss: 1.0028746128082275, PLCC: 0.19724753904141223
	speed: 0.0510s/iter; left time: 1173.6174s
[[[0.4575187 ]
  [0.43844622]
  [0.4249478 ]
  [0.41668838]
  [0.4170473 ]
  [0.43246388]
  [0.41713235]
  [0.4594767 ]]

 [[0.788914  ]
  [0.80282396]
  [0.815083  ]
  [0.7965265 ]
  [0.9361186 ]
  [0.964778  ]
  [0.991664  ]
  [1.0239116 ]]] [[[0.4305431 ]
  [0.4305431 ]
  [0.43800116]
  [0.43800116]
  [0.43800116]
  [0.42447832]
  [0.42447832]
  [0.40905577]]

 [[0.7167222 ]
  [0.7167222 ]
  [0.7167222 ]
  [0.6913533 ]
  [0.6913533 ]
  [0.6913533 ]
  [0.6162197 ]
  [0.6162197 ]]]
mae:0.08182811737060547, mse:0.013090317137539387, rmse:0.11441292613744736, mape:13803.224609375, mspe:74627375104.0, plcc:0.19089527904096915, srcc:0.17464764551527195
[[[0.5767357 ]
  [0.5886013 ]
  [0.60517603]
  [0.62325156]
  [0.6510168 ]
  [0.6592407 ]
  [0.6721359 ]
  [0.6848234 ]]

 [[0.14325094]
  [0.18776116]
  [0.19313693]
  [0.21333006]
  [0.23432522]
  [0.26720625]
  [0.29782248]
  [0.33832335]]] [[[0.5164767 ]
  [0.54399484]
  [0.54399484]
  [0.57045054]
  [0.57045054]
  [0.6332054 ]
  [0.6332054 ]
  [0.6814267 ]]

 [[0.17599122]
  [0.17599122]
  [0.1414615 ]
  [0.1414615 ]
  [0.16874573]
  [0.16874573]
  [0.13427912]
  [0.10220694]]]
mae:0.07949966937303543, mse:0.012033157050609589, rmse:0.10969574749469757, mape:13566.9541015625, mspe:80978264064.0, plcc:0.24379912488378205, srcc:0.23066374535404588
Validation loss decreased (inf --> 0.012033).  Saving model ...
Updating learning rate to 0.0001
Epoch: 2, Iter: 1000/1201, Loss1: 0.16669324040412903, Loss2: 0.9567665457725525, Loss: 1.123459815979004, PLCC: 0.04323345116729603
	speed: 0.0743s/iter; left time: 1621.7895s
[[[0.33096775]
  [0.30397117]
  [0.29743448]
  [0.30502024]
  [0.30467626]
  [0.29835832]
  [0.3002195 ]
  [0.27104387]]

 [[0.30805624]
  [0.35141692]
  [0.3738197 ]
  [0.38635048]
  [0.39539334]
  [0.4031761 ]
  [0.41299456]
  [0.4192871 ]]] [[[0.30646563]
  [0.30646563]
  [0.2966199 ]
  [0.28966212]
  [0.28966212]
  [0.29613236]
  [0.29613236]
  [0.28726012]]

 [[0.35874328]
  [0.38596883]
  [0.38596883]
  [0.3565315 ]
  [0.3565315 ]
  [0.39850757]
  [0.39850757]
  [0.39850757]]]
mae:0.07056349515914917, mse:0.01070888340473175, rmse:0.10348373651504517, mape:10244.671875, mspe:57257693184.0, plcc:0.21502091796872638, srcc:0.20966548833894516
[[[0.11563236]
  [0.07564711]
  [0.03890225]
  [0.02690428]
  [0.01873135]
  [0.00321036]
  [0.00706618]
  [0.03525703]]

 [[0.74012625]
  [0.79135555]
  [0.82622993]
  [0.8516755 ]
  [0.85695547]
  [0.8624053 ]
  [0.8663517 ]
  [0.80167073]]] [[[0.07693496]
  [0.09475981]
  [0.09475981]
  [0.09475981]
  [0.1775737 ]
  [0.1775737 ]
  [0.1775737 ]
  [0.2366948 ]]

 [[0.7501266 ]
  [0.72173256]
  [0.7376187 ]
  [0.7376187 ]
  [0.6901807 ]
  [0.6901807 ]
  [0.56522006]
  [0.56522006]]]
mae:0.0688493475317955, mse:0.010319523513317108, rmse:0.10158505290746689, mape:10217.8154296875, mspe:58937982976.0, plcc:0.22497617880293577, srcc:0.20785653642974347
Validation loss decreased (0.012033 --> 0.010320).  Saving model ...
Updating learning rate to 5e-05
Epoch: 3, Iter: 1000/1201, Loss1: 0.0782545804977417, Loss2: 0.7748653888702393, Loss: 0.853119969367981, PLCC: 0.2251345930445536
	speed: 0.0717s/iter; left time: 1478.5798s
[[[0.867926  ]
  [0.9020899 ]
  [0.92690426]
  [0.9311087 ]
  [0.9299343 ]
  [0.9304031 ]
  [0.9205577 ]
  [0.88440114]]

 [[0.38292   ]
  [0.4142099 ]
  [0.44108102]
  [0.457093  ]
  [0.47451738]
  [0.49374205]
  [0.50724363]
  [0.51341176]]] [[[0.97048813]
  [0.97048813]
  [1.        ]
  [1.        ]
  [0.9638308 ]
  [0.9638308 ]
  [0.78885806]
  [0.61607903]]

 [[0.39632636]
  [0.45833793]
  [0.45833793]
  [0.51136595]
  [0.6389788 ]
  [0.75233364]
  [0.75233364]
  [0.9395205 ]]]
mae:0.06738384068012238, mse:0.009893376380205154, rmse:0.09946545213460922, mape:10514.291015625, mspe:56050974720.0, plcc:0.22678533092728703, srcc:0.21954130666050253
[[[0.429831  ]
  [0.46048057]
  [0.4859271 ]
  [0.49868527]
  [0.5099788 ]
  [0.5173927 ]
  [0.52891606]
  [0.48225555]]

 [[0.43196708]
  [0.31097382]
  [0.29101077]
  [0.33605012]
  [0.27773476]
  [0.21705556]
  [0.2150129 ]
  [0.22684588]]] [[[0.48221186]
  [0.48221186]
  [0.5154387 ]
  [0.5154387 ]
  [0.60639125]
  [0.60639125]
  [0.58769804]
  [0.58769804]]

 [[0.30471763]
  [0.3460899 ]
  [0.3460899 ]
  [0.2705933 ]
  [0.2705933 ]
  [0.22129433]
  [0.22129433]
  [0.22129433]]]
mae:0.06747188419103622, mse:0.010097059421241283, rmse:0.10048412531614304, mape:11019.39453125, mspe:70274785280.0, plcc:0.22767024577412281, srcc:0.21266235446294524
Validation loss decreased (0.010320 --> 0.010097).  Saving model ...
Updating learning rate to 2.5e-05
Epoch: 4, Iter: 1000/1201, Loss1: 0.08758269995450974, Loss2: 0.5756844878196716, Loss: 0.663267195224762, PLCC: 0.42431549297636906
	speed: 0.0708s/iter; left time: 1375.3096s
[[[0.4101713 ]
  [0.44235626]
  [0.46520102]
  [0.48154566]
  [0.49587068]
  [0.5098408 ]
  [0.522527  ]
  [0.5249883 ]]

 [[0.64908224]
  [0.6438499 ]
  [0.6592833 ]
  [0.6579826 ]
  [0.6649812 ]
  [0.6612088 ]
  [0.6545946 ]
  [0.6600822 ]]] [[[0.48221186]
  [0.48221186]
  [0.5154387 ]
  [0.5154387 ]
  [0.60639125]
  [0.60639125]
  [0.58769804]
  [0.58769804]]

 [[0.54269147]
  [0.54269147]
  [0.51877415]
  [0.51877415]
  [0.6010739 ]
  [0.6010739 ]
  [0.5041499 ]
  [0.5041499 ]]]
mae:0.06582370400428772, mse:0.009932481683790684, rmse:0.09966183453798294, mape:10542.13671875, mspe:60655185920.0, plcc:0.22227547090275437, srcc:0.20999455292884545
[[[0.06835815]
  [0.07889163]
  [0.08072596]
  [0.08669802]
  [0.09548872]
  [0.10340685]
  [0.09813531]
  [0.08389731]]

 [[0.1302364 ]
  [0.11350825]
  [0.10509811]
  [0.10567195]
  [0.09884993]
  [0.08962478]
  [0.08895665]
  [0.11750411]]] [[[0.05011626]
  [0.05011626]
  [0.07868724]
  [0.1080736 ]
  [0.1080736 ]
  [0.1412574 ]
  [0.170021  ]
  [0.170021  ]]

 [[0.10831375]
  [0.10831375]
  [0.14147848]
  [0.14147848]
  [0.13564554]
  [0.13564554]
  [0.13564554]
  [0.17901455]]]
mae:0.06637304276227951, mse:0.009713485836982727, rmse:0.0985570177435875, mape:11602.29296875, mspe:66848956416.0, plcc:0.24517203668817325, srcc:0.23333091471322698
Validation loss decreased (0.010097 --> 0.009713).  Saving model ...
Updating learning rate to 1.25e-05
Epoch: 5, Iter: 1000/1201, Loss1: 0.05916391685605049, Loss2: 0.6256123781204224, Loss: 0.6847763061523438, PLCC: 0.37438762213794463
	speed: 0.0695s/iter; left time: 1265.6086s
[[[0.4833758 ]
  [0.5123734 ]
  [0.5314891 ]
  [0.54570967]
  [0.557873  ]
  [0.5672642 ]
  [0.58131427]
  [0.58573395]]

 [[0.25233   ]
  [0.27826032]
  [0.28712064]
  [0.29403546]
  [0.30077612]
  [0.3047138 ]
  [0.31544185]
  [0.32552534]]] [[[0.47417104]
  [0.53395087]
  [0.53395087]
  [0.53395087]
  [0.64007825]
  [0.64007825]
  [0.64007825]
  [0.6770223 ]]

 [[0.23374091]
  [0.18989173]
  [0.18989173]
  [0.18989173]
  [0.17657661]
  [0.17657661]
  [0.17657661]
  [0.18605874]]]
mae:0.06500332802534103, mse:0.009744108654558659, rmse:0.0987122505903244, mape:10451.7236328125, mspe:59491368960.0, plcc:0.23103265193959752, srcc:0.22088605850450282
[[[ 0.09462845]
  [ 0.09958751]
  [ 0.09936281]
  [ 0.09675636]
  [ 0.10492868]
  [ 0.11604347]
  [ 0.11661565]
  [ 0.11576121]]

 [[ 0.06272467]
  [ 0.03674337]
  [ 0.01374572]
  [ 0.00676923]
  [ 0.00236635]
  [ 0.00128969]
  [-0.00747038]
  [ 0.00544207]]] [[[0.07502236]
  [0.05970611]
  [0.05970611]
  [0.0922777 ]
  [0.0922777 ]
  [0.09671094]
  [0.09671094]
  [0.1353837 ]]

 [[0.0261931 ]
  [0.0261931 ]
  [0.01365983]
  [0.01365983]
  [0.00497266]
  [0.00497266]
  [0.0083104 ]
  [0.0083104 ]]]
mae:0.06355565041303635, mse:0.009448792785406113, rmse:0.09720490127801895, mape:10832.7880859375, mspe:67666767872.0, plcc:0.23950286243333974, srcc:0.21898884084648915
Validation loss decreased (0.009713 --> 0.009449).  Saving model ...
Updating learning rate to 6.25e-06
Epoch: 6, Iter: 1000/1201, Loss1: 0.08708804845809937, Loss2: 0.8598856925964355, Loss: 0.9469737410545349, PLCC: 0.14011432848292163
	speed: 0.0711s/iter; left time: 1209.0179s
[[[0.0740379 ]
  [0.08073174]
  [0.07284968]
  [0.1019705 ]
  [0.11370852]
  [0.1387074 ]
  [0.1590231 ]
  [0.18962677]]

 [[0.64251834]
  [0.67359954]
  [0.6843862 ]
  [0.6978729 ]
  [0.7095874 ]
  [0.7191662 ]
  [0.73183113]
  [0.7560709 ]]] [[[0.07582178]
  [0.06723156]
  [0.06723156]
  [0.06723156]
  [0.06567007]
  [0.06567007]
  [0.06567007]
  [0.06242879]]

 [[0.65335804]
  [0.6560076 ]
  [0.6560076 ]
  [0.66214633]
  [0.6760751 ]
  [0.6760751 ]
  [0.6727093 ]
  [0.6774017 ]]]
mae:0.06465043872594833, mse:0.009648936800658703, rmse:0.09822899848222733, mape:11055.708984375, mspe:64959328256.0, plcc:0.2279418795935263, srcc:0.21498755770379335
[[[0.8112242 ]
  [0.81362087]
  [0.8153362 ]
  [0.825673  ]
  [0.8157054 ]
  [0.8208235 ]
  [0.8190315 ]
  [0.82095027]]

 [[0.25108108]
  [0.26766708]
  [0.27689505]
  [0.27944908]
  [0.27938938]
  [0.2782271 ]
  [0.2818537 ]
  [0.28047782]]] [[[0.8166164 ]
  [0.8166164 ]
  [0.8166838 ]
  [0.8166838 ]
  [0.8056987 ]
  [0.8056987 ]
  [0.7591535 ]
  [0.7591535 ]]

 [[0.21140818]
  [0.24492505]
  [0.24492505]
  [0.24492505]
  [0.3857267 ]
  [0.3857267 ]
  [0.3857267 ]
  [0.60469997]]]
mae:0.06352738291025162, mse:0.009441070258617401, rmse:0.09716516733169556, mape:10643.783203125, mspe:62706241536.0, plcc:0.24122457542778153, srcc:0.2268814378459301
Validation loss decreased (0.009449 --> 0.009441).  Saving model ...
Updating learning rate to 3.125e-06
Epoch: 7, Iter: 1000/1201, Loss1: 0.1302167922258377, Loss2: 0.6767715215682983, Loss: 0.8069882988929749, PLCC: 0.32322846579650893
	speed: 0.0711s/iter; left time: 1124.0215s
[[[0.11225434]
  [0.10034838]
  [0.08640318]
  [0.08286776]
  [0.07817387]
  [0.07491644]
  [0.07401317]
  [0.08905255]]

 [[0.25036657]
  [0.22262423]
  [0.20635693]
  [0.20001508]
  [0.19608963]
  [0.19955516]
  [0.18881059]
  [0.18785828]]] [[[0.12385943]
  [0.12385943]
  [0.12385943]
  [0.12502219]
  [0.12502219]
  [0.12502219]
  [0.13286184]
  [0.13286184]]

 [[0.19005598]
  [0.19005598]
  [0.17071123]
  [0.17071123]
  [0.15966019]
  [0.15966019]
  [0.13701542]
  [0.13701542]]]
mae:0.06381779164075851, mse:0.009617278352379799, rmse:0.09806772321462631, mape:10668.4921875, mspe:63531462656.0, plcc:0.23881592989270017, srcc:0.22593118159472755
[[[0.12985899]
  [0.11492271]
  [0.10165582]
  [0.10164645]
  [0.10294195]
  [0.11039173]
  [0.11226515]
  [0.13560063]]

 [[0.24645935]
  [0.22521834]
  [0.20432816]
  [0.19435051]
  [0.18588518]
  [0.17854789]
  [0.16832075]
  [0.17715664]]] [[[0.11413377]
  [0.11413377]
  [0.11413377]
  [0.12250298]
  [0.12250298]
  [0.12250298]
  [0.1294788 ]
  [0.1294788 ]]

 [[0.19104621]
  [0.19104621]
  [0.18270853]
  [0.20409136]
  [0.20409136]
  [0.2078489 ]
  [0.19351104]
  [0.19351104]]]
mae:0.06419941782951355, mse:0.00971943885087967, rmse:0.09858721494674683, mape:10494.240234375, mspe:61232541696.0, plcc:0.23160090597299976, srcc:0.2206545159529274
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-06
Epoch: 8, Iter: 1000/1201, Loss1: 0.09584552049636841, Loss2: 0.9652664661407471, Loss: 1.0611119270324707, PLCC: 0.034733533117965495
	speed: 0.0712s/iter; left time: 1040.1133s
[[[0.0961444 ]
  [0.10596067]
  [0.1090759 ]
  [0.11578754]
  [0.12186854]
  [0.13093178]
  [0.13639872]
  [0.1455232 ]]

 [[0.09251704]
  [0.09896272]
  [0.10978166]
  [0.10161699]
  [0.09697106]
  [0.09447827]
  [0.11161578]
  [0.09213679]]] [[[8.1679724e-02]
  [7.6099537e-02]
  [7.6099537e-02]
  [6.4458840e-02]
  [4.8348390e-02]
  [4.8348390e-02]
  [3.8200490e-02]
  [3.8200490e-02]]

 [[8.5975789e-02]
  [5.3048603e-02]
  [5.3048603e-02]
  [5.3048603e-02]
  [2.0515550e-08]
  [2.0515550e-08]
  [5.3089641e-02]
  [5.3089641e-02]]]
mae:0.06359613686800003, mse:0.009482921101152897, rmse:0.09738028794527054, mape:10594.6640625, mspe:62548918272.0, plcc:0.24191799356875313, srcc:0.22821168745094672
[[[0.31140104]
  [0.28460407]
  [0.26214895]
  [0.25165397]
  [0.2422957 ]
  [0.23916991]
  [0.22564717]
  [0.21350719]]

 [[0.45349938]
  [0.43518564]
  [0.4393272 ]
  [0.44511947]
  [0.501238  ]
  [0.46937168]
  [0.46594232]
  [0.4801256 ]]] [[[0.23709637]
  [0.23709637]
  [0.21812415]
  [0.21812415]
  [0.19535731]
  [0.19535731]
  [0.19535731]
  [0.17634173]]

 [[0.40282005]
  [0.40282005]
  [0.39865172]
  [0.39865172]
  [0.3954017 ]
  [0.3954017 ]
  [0.39168411]
  [0.39168411]]]
mae:0.06438922137022018, mse:0.009629743173718452, rmse:0.09813125431537628, mape:10817.9150390625, mspe:63894282240.0, plcc:0.23730609523722496, srcc:0.2239752321784665
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-07
Epoch: 9, Iter: 1000/1201, Loss1: 0.09401489049196243, Loss2: 0.7344373464584351, Loss: 0.8284522294998169, PLCC: 0.26556264861676954
	speed: 0.0712s/iter; left time: 954.9878s
[[[0.31845137]
  [0.29708308]
  [0.23599324]
  [0.20790128]
  [0.19116962]
  [0.15844122]
  [0.10770739]
  [0.11549959]]

 [[0.45201805]
  [0.42944166]
  [0.400286  ]
  [0.36591202]
  [0.3703989 ]
  [0.35924098]
  [0.34806696]
  [0.33603445]]] [[[0.17225938]
  [0.17225938]
  [0.18171132]
  [0.18171132]
  [0.18171132]
  [0.15536533]
  [0.15536533]
  [0.21226647]]

 [[0.39491767]
  [0.39491767]
  [0.30100113]
  [0.30100113]
  [0.30100113]
  [0.45539042]
  [0.45539042]
  [0.30471763]]]
mae:0.06381037831306458, mse:0.00953697320073843, rmse:0.09765742719173431, mape:10651.021484375, mspe:63017107456.0, plcc:0.2365614549098116, srcc:0.22375031242072368
[[[0.3052378 ]
  [0.3302995 ]
  [0.34589356]
  [0.36073112]
  [0.37280822]
  [0.38621527]
  [0.3999302 ]
  [0.412008  ]]

 [[0.8444415 ]
  [0.8152051 ]
  [0.7816274 ]
  [0.75960284]
  [0.74331915]
  [0.72570264]
  [0.7001373 ]
  [0.7147807 ]]] [[[0.314088  ]
  [0.3056188 ]
  [0.3056188 ]
  [0.29401112]
  [0.29401112]
  [0.3128523 ]
  [0.3128523 ]
  [0.33653402]]

 [[0.6784469 ]
  [0.6784469 ]
  [0.6431915 ]
  [0.6431915 ]
  [0.6318618 ]
  [0.6318618 ]
  [0.6147254 ]
  [0.60719836]]]
mae:0.0639960989356041, mse:0.00957940798252821, rmse:0.09787444770336151, mape:10662.9287109375, mspe:63093592064.0, plcc:0.23729632652873675, srcc:0.22407811521484486
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_bandwidth_16_16_Autoformer_video_ftS_sl8_ll1_pl8_dm512_nh8_el2_dl1_df2048_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 16486
test shape: (16486, 8, 1) (16486, 8, 1)
test shape: (16486, 8, 1) (16486, 8, 1)
mae:0.06313841789960861, mse:0.009845297783613205, rmse:0.09922347217798233, mape:10457.6953125, mspe:46228652032.0, plcc:0.2563303414022188, srcc:0.242980467296799
